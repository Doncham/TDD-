# 동시성 제어 방식
본 프로젝트에서는 자바의 synchronized 키워드를 사용하여 임계 영역을 보호했다.
synchronized는 모니터 락(Monitor Lock) 을 기반으로 동작하며,
동일한 객체에 대해 한 시점에 오직 하나의 스레드만 락을 획득할 수 있다.

<img width="930" height="681" alt="스크린샷 2025-10-23 오후 8 14 07" src="https://github.com/user-attachments/assets/27e250a2-4b28-4ece-8032-43dfd000d25a" />

## 동시성이 깨지는 이유
여러 스레드가 하나의 공유 데이터에 대한 조회 -> 변경 -> 쓰기 작업을 한다면 한 스레드가 변경한 사항이 다른 스레드의 쓰기 작업으로 인해 덮어씌워져서 원하는 결과를 얻지 못한다.(Lost Update) 이렇게 여러 스레드가 동시에 접근하면 안되는 영역을 임계 영역이라고 하고 임계 영역에는 한 번에 하나의 스레드만 접근해서 동시성을 제어하도록 해야한다.

## 동시성이 깨지는 예시
스레드 A와 스레드 B가 동시에 포인트 충전을 하는 상황(현재 포인트 100, 충전할 포인트 100, 충전 횟수 2번, 예상 결과 300) 

A: 포인트 조회(100)

B: 포인트 조회(100)

A: 포인트 변경(200)

B: 포인트 변경(200)

A: 포인트 저장(200)

B: 포인트 저장(200)

최종 결과: 200(예상한 300과 달라짐)

## 동시성 제어 원리
- 한 스레드가 synchronized 블록(또는 메서드)에 진입할 때 **모니터 락**을 획득한다.
- 이미 다른 스레드가 락을 보유 중이라면, 현재 스레드는 대기 큐(Wait Queue) 에 들어가 **BLOCKED 상태**로 대기한다.
- 락을 가진 스레드가 임계 영역을 모두 수행하고 락을 해제하면, 대기 중이던 스레드 중 하나가 깨워져 락을 획득하고 실행을 재개한다
- 임계 영역에는 항상 단일 스레드만 접근 가능하여 데이터의 조회 → 변경 → 쓰기 작업이 원자적으로 처리된다.
- 그로 인해, 다른 스레드가 임계 영역에 한 번에 하나의 스레드만 접근하여 동시성을 제어할 수 있다.


